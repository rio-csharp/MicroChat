@page "/"
@using MicroChat.Client.Models
@using MicroChat.Client.Services
@inject ConversationService ConversationService

@rendermode @(new InteractiveWebAssemblyRenderMode(prerender: false))

<div class="layout @(ShowMobileContent ? "show-content" : "") @(IsContainerMode ? "container-mode" : "")">
    <Sidebar OnChatSelected="HandleChatSelected" />
    <div class="content">
        <ChatHeader @key="ConversationService.SelectedConversation?.Id"
                    OnBackClicked="HandleBackToList"
                    ShowBackButton="ShowMobileContent"
                    IsContainerMode="IsContainerMode"
                    OnToggleContainerMode="ToggleContainerMode" />
        <div class="chat-area">
            <ChatPanel @key="ConversationService.SelectedConversation?.Id" />
        </div>
    </div>
</div>

@code {
    private bool ShowMobileContent = false;
    private bool IsContainerMode = false;

    private void HandleChatSelected()
    {
        ShowMobileContent = true;
    }

    private void HandleBackToList()
    {
        ShowMobileContent = false;
    }

    private void ToggleContainerMode()
    {
        IsContainerMode = !IsContainerMode;
    }
}
