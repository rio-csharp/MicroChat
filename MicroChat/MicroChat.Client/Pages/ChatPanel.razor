@using MicroChat.Client.Models
@using MicroChat.Client.Components

@if (ConversationService.SelectedConversation != null)
{
    <div class="chat-panel">
        <div class="chat-messages" id="chat-messages-container">
            @foreach (var message in ConversationService.SelectedConversation.Messages)
            {
                <MessageItem Message="@message" />
            }
            @if (ConversationService.SelectedConversation.IsStreaming && ConversationService.SelectedConversation.StreamingMessage != null)
            {
                <MessageItem Message="@ConversationService.SelectedConversation.StreamingMessage"
                             IsStreaming="true" />
            }
        </div>

        @if (!_isAtBottom && !_isAtTop)
        {
            <button class="scroll-button scroll-to-bottom" @onclick="ScrollToBottomAsync" title="跳转到最新消息">
                <span class="arrow-down">↓</span>
            </button>

            <button class="scroll-button scroll-to-top" @onclick="ScrollToTopAsync" title="跳转到最早消息">
                <span class="arrow-up">↑</span>
            </button>
        }

        <ChatInput IsStreaming="@ConversationService.SelectedConversation.IsStreaming" />
    </div>
}
else
{
    <div class="chat-panel-empty">
        <h3>请从左侧选择一个聊天</h3>
    </div>
}
